{% load budget static %}

<!DOCTYPE html>
<link rel="stylesheet" href="{% static 'budget/style.css' %}">
<script src="{% static 'budget/editor.js' %}"></script>

<form class="edit" action="{{ request.get_full_path }}" method="post">
    <table>
        <tr>
            <th>Date</th>
            <th>Note</th>
        </tr>
        <tr>
            <td>{{ form.date }}</td>
            <td>{{ form.description }}</td>
        </tr>
    </table>
    <table id="parts">
        <tr>
            <th>Account</th>
            <th>Category</th>
            <th>Transferred</th>
            <th>Categorized</th>
        </tr>
        {% for form in formset %}
        <tr>
            <td>
                {{ form.account }}<input list="account-list" size="12">
            </td>
            <td>
                {{ form.category }}<input list="category-list" size="12">
            </td>
            <td>{{ form.transferred }}</td>
            <td>{{ form.moved }}</td>
        </tr>
        {% endfor %}
        <tr id="adder-row" style="text-align:right;">
            <td colspan="6"><button id="addrow" type="button">+</button></td>
        </tr>
    </table>
    <p id="category-sum"></p>
    <p id="account-sum"></p>
    <p id="debt"></p>

    {{ formset.management_form }}
    {% csrf_token %}
    <input id="submit-button" type="submit" value="Save">
    <button id="cancel" type="button">Cancel</button>
</form>
{% if transaction_id %}
<form class="edit" action="{% url 'delete' transaction_id%}?next={{ request.GET.back|urlencode }}" method="post">
    {% csrf_token %}
    <input type="submit" value="Delete">
</form>
{% endif %}
<datalist id="account-list">
    {% for account, id in data.accounts %}
    <option value="{{ account }}"></option>
    {% endfor %}
</datalist>
<datalist id="category-list">
    {% for category, id in data.categories %}
    <option value="{{ category }}"></option>
    {% endfor %}
</datalist>

{{ data|json_script:"data" }}
{{ form.errors|default:"" }}
{{ formset.errors|default:"" }}
{{ formset.non_form_errors }}
