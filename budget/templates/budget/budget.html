{% load budget %}

<!DOCTYPE html>
{% url 'budget' budget_id as budget_url %}
{% if request.get_full_path != budget_url %}
<a href="{{ budget_url }}">Back to Budget</a>
{% endif %}
<table>
    <th>Date</th>
    <th>Note</th>
    <th>From</th>
    <th>To</th>
    <th>Category</th>
    <th>Amount</th>
    <th>Total</th>
    {% for transaction in transactions %}
    {% with parts=transaction|transaction_display %}
    {% for part in parts %}
    {% if forloop.first %}
    <tr class="{% cycle 'a' 'b' as rowcolor %}">
        <td>{{transaction.date}}</td>
        <td>{{transaction.description}}</td>
        {% else %}
    <tr class="{{ rowcolor }}">
        <td></td>
        <td></td>
        {% endif %}
        <td>{% account_in_budget part.from.to budget_id %}</td>
        <td>{% account_in_budget part.to.to budget_id %}</td>
        <td>{% account_in_budget part.category.to budget_id %}</td>
        <td>{{part.amount}}</td>
        <td>{% if forloop.first %}
            {{ transaction.running_sum }}
            {% endif %}
        </td>
    </tr>
    {% endfor %}
    {% endwith %}
    {% endfor %}
</table>

<style>
    table {
        border-collapse: collapse;
    }

    tr.a {
        background-color: #e0f0eb;
    }

    td,
    th {
        border: 1px solid #888;
        padding: 1px 2px;
    }

</style>
