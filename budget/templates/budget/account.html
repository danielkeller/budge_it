{% load budget static %}

<!DOCTYPE html>
<link rel="stylesheet" href="{% static 'budget/style.css' %}">
<script src="{% static 'budget/account.js' %}"></script>

<div><a href="{% url 'overview' account.budget_id %}">Overview</a></div>
{% url 'budget' account.budget_id as budget_url %}

<div>
    <form method="post">
        {{ form.name }}
        {% csrf_token %}
        <button>Rename</button>
    </form>
</div>
<div><button type="button" id="new">Add transaction</button></div>
<table id="table">
    <th>Date</th>
    <th>Description</th>
    <th>Amount</th>
    <th>Total</th>
    {% for entry in entries %}
    <tr class="{% cycle 'a' 'b' as rowcolor %}" tabindex="0" data-id="{{entry.transaction.id}}"
        data-kind="{{entry.transaction.kind}}">
        <td>{{entry.transaction.date}}</td>
        <td>{{entry.transaction|transaction_description:account}}</td>
        <td>{{entry.amount}}</td>
        <td>
            {{entry.running_sum}}
            <div class="detail-container">
                <div class="transaction-detail">
                    <span class="line">──┐</span>
                    <table class="transaction-detail-table">
                        <th>Account</th>
                        <th>Category</th>
                        <th>Amount</th>
                        {% for part in entry.transaction|tabular:account.budget %}
                        <tr class="{% cycle 'a' 'b' %}">
                            <td>{% account_in_budget part.account account.budget %}</td>
                            <td>{% account_in_budget part.category account.budget %}</td>
                            <td>{{part.amount}}</td>
                        </tr>
                        {% endfor %}
                        {% resetcycle %}
                    </table>
                </div>
            </div>
        </td>
    </tr>
    {% endfor %}
</table>
{{ data|json_script:"data" }}
